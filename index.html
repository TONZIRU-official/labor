<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>åœ°ä¸‹åŠ´åƒæ–½è¨­ - æ¥µé™ä½œæ¥­åŒº</title>
    <script src="https://cdn.jsdelivr.net/npm/@discord/embedded-app-sdk@1.0.0/dist/index.js"></script>
    <style>
        body { background: #000; color: #0f0; font-family: 'Courier New', Courier, monospace; overflow: hidden; height: 100vh; margin: 0; }
        #game-container { position: relative; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .rock { font-size: 80px; cursor: pointer; position: absolute; user-select: none; transition: 0.05s; }
        #ui { position: fixed; top: 20px; text-align: center; width: 100%; z-index: 100; pointer-events: none; }
        .blackout { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: black; display: none; z-index: 1000; align-items: center; justify-content: center; color: white; }
    </style>
</head>
<body>
    <div id="ui">
        <h1>â›ï¸ æ¥µé™åŠ´åƒåŒº â›ï¸</h1>
        <p id="status">ä½œæ¥­ã‚’ç¶™ç¶šã›ã‚ˆ</p>
        <h2 id="counter">0 / 200</h2>
    </div>

    <div id="game-container">
        <div class="rock" id="rock" style="top: 50%; left: 50%;">ğŸª¨</div>
    </div>

    <div id="blackout" class="blackout"><h1>ğŸ”Œ åœé›»ç™ºç”Ÿ ğŸ”Œ</h1></div>

    <script>
        const discordSdk = new window.discordSdk.DiscordSDK("1455043505750806703");
        async function setup() { await discordSdk.ready(); }
        setup();

        let count = 0;
        const quota = 200; // ãƒãƒ«ãƒã‚’200ã¸
        const rock = document.getElementById('rock');
        const counter = document.getElementById('counter');
        const status = document.getElementById('status');
        const blackout = document.getElementById('blackout');

        // æ—¥æ›¿ã‚ã‚Šã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
        const date = new Date().toISOString().slice(0, 10);
        const dailyCode = "LABOR-" + btoa(date).slice(0, 5).toUpperCase();

        rock.onclick = () => {
            // 20%ã®ç¢ºç‡ã§ç©ºæŒ¯ã‚Šï¼ˆç†ä¸å°½1ï¼‰
            if (Math.random() < 0.2) {
                status.innerText = "ğŸ’¢ ç©ºæŒ¯ã‚Šï¼";
                status.style.color = "red";
                moveRock();
                return;
            }

            count++;
            counter.innerText = `${count} / ${quota}`;
            status.innerText = "æ¡æ˜æˆåŠŸ";
            status.style.color = "#0f0";

            // å²©ãŒãƒ©ãƒ³ãƒ€ãƒ ã«é€ƒã’ã‚‹ï¼ˆç†ä¸å°½2ï¼‰
            moveRock();

            // 40å›ã”ã¨ã«åœé›»ï¼ˆç†ä¸å°½3ï¼‰
            if (count % 40 === 0 && count < quota) {
                triggerBlackout();
            }

            if (count >= quota) {
                rock.style.display = 'none';
                status.innerHTML = `<h2>åŠ´åƒå®Œäº†ã€‚ã‚³ãƒ¼ãƒ‰ï¼š<br><span style="color:yellow;">${dailyCode}</span></h2>`;
            }
        };

        function moveRock() {
            const x = Math.random() * 70 + 15; // 15% - 85% ã®é–“
            const y = Math.random() * 70 + 15;
            rock.style.left = x + "%";
            rock.style.top = y + "%";
        }

        function triggerBlackout() {
            blackout.style.display = 'flex';
            setTimeout(() => {
                blackout.style.display = 'none';
            }, 3000); // 3ç§’é–“ä½•ã‚‚ã§ããªã„
        }
    </script>
</body>
</html>

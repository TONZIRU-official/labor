<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>地下労働施設</title>
    <script src="https://cdn.jsdelivr.net/npm/@discord/embedded-app-sdk@1.0.0/dist/index.js"></script>
    <style>
        body { background: #0c0c0c; color: #00ff41; font-family: 'Consolas', monospace; text-align: center; margin-top: 50px; }
        .container { border: 2px solid #00ff41; padding: 20px; display: inline-block; box-shadow: 0 0 15px #00ff41; }
        #mineBtn { background: #00ff41; color: black; border: none; padding: 20px 40px; font-size: 1.5rem; cursor: pointer; margin: 20px; font-weight: bold; }
        #mineBtn:active { transform: scale(0.95); background: #00cc33; }
        .hidden { display: none; }
        .code { font-size: 2rem; color: #ffff00; text-shadow: 0 0 5px #ffff00; }
    </style>
</head>
<body>
    <div class="container">
        <h1>[ 地下労働セクター B-1 ]</h1>
        <p>石炭を77回採掘して、今日の完了コードを取得せよ。</p>
        <h2 id="counter">0 / 77</h2>
        <button id="mineBtn">採掘実行</button>
        <div id="finishArea" class="hidden">
            <p>労働完了。以下のコードをDiscordで入力せよ：</p>
            <div id="resultCode" class="code"></div>
        </div>
    </div>

    <script>
        // クライアントID（BotのApplication ID）に書き換えてください
        const discordSdk = new window.discordSdk.DiscordSDK("あなたのBotのApplicationID");

        async function setupDiscord() {
            try { await discordSdk.ready(); } catch(e) { console.log("Discord外での閲覧中"); }
        }
        setupDiscord();

        // 日替わりパスワード生成 (Bot側と一致させる)
        function generateDailyCode() {
            const date = new Date().toISOString().slice(0, 10); // "2023-10-27"
            return "LABOR-" + btoa(date).slice(0, 5).toUpperCase();
        }

        let count = 0;
        const btn = document.getElementById('mineBtn');
        const counter = document.getElementById('counter');
        const finishArea = document.getElementById('finishArea');
        const resultCode = document.getElementById('resultCode');

        btn.onclick = () => {
            count++;
            counter.innerText = count + " / 77";
            if(count >= 77) {
                btn.classList.add('hidden');
                finishArea.classList.remove('hidden');
                resultCode.innerText = generateDailyCode();
            }
        };
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>åœ°ä¸‹åŠ´åƒæ–½è¨­ - ç¬¬å››å¼·åˆ¶åŠ´åƒåŒº</title>
    <script src="https://cdn.jsdelivr.net/npm/@discord/embedded-app-sdk@1.0.0/dist/index.js"></script>
    <style>
        body { background: #050505; color: #44ff44; font-family: 'serif'; text-align: center; overflow: hidden; }
        #labor-box { margin-top: 10vh; border: 3px solid #333; display: inline-block; padding: 40px; background: #111; }
        .rock { font-size: 50px; cursor: pointer; user-select: none; transition: 0.1s; display: inline-block; }
        .rock:active { transform: scale(0.8) rotate(10deg); }
        #progress-bar { width: 300px; height: 20px; border: 1px solid #44ff44; margin: 20px auto; }
        #progress-fill { width: 0%; height: 100%; background: #44ff44; transition: 0.3s; }
        .warning { color: red; font-weight: bold; animation: blink 0.5s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0; } }
    </style>
</head>
<body>
    <div id="labor-box">
        <h1>â›ï¸ ç¬¬å››å¼·åˆ¶åŠ´åƒåŒº â›ï¸</h1>
        <p>çŸ³ã‚’ç •ã„ã¦ã€Œã‚¯ã‚ºé‰„ã€ã‚’150å€‹é›†ã‚ã‚ã€‚ã‚µãƒœã‚‹ãªã€‚</p>
        
        <div id="status">ç›£è¦–ä¸­...</div>
        <div id="progress-bar"><div id="progress-fill"></div></div>
        <h2 id="counter">0 / 150</h2>
        
        <div id="rock-area">
            <div class="rock" id="rock">ğŸª¨</div>
        </div>

        <div id="finishArea" style="display:none;">
            <p class="warning">åŠ´åƒå®Œäº†ã€‚è§£æ”¾ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¡ãƒ¢ã›ã‚ˆï¼š</p>
            <h2 id="resultCode" style="color:yellow; font-size:30px;"></h2>
        </div>
    </div>

    <script>
        const discordSdk = new window.discordSdk.DiscordSDK("1455043505750806703");
        async function setup() { await discordSdk.ready(); }
        setup();

        let count = 0;
        let lastClick = Date.now();
        const quota = 150; // ãƒãƒ«ãƒã‚’150ã«å¢—åŠ 

        // æ—¥æ›¿ã‚ã‚Šã‚³ãƒ¼ãƒ‰
        const date = new Date().toISOString().slice(0, 10);
        const dailyCode = "LABOR-" + btoa(date).slice(0, 5).toUpperCase();

        const rock = document.getElementById('rock');
        const fill = document.getElementById('progress-fill');
        const counter = document.getElementById('counter');

        rock.onclick = () => {
            count++;
            lastClick = Date.now();
            updateUI();
            
            // å©ããŸã³ã«å²©ãŒæºã‚Œã‚‹æ¼”å‡º
            rock.style.marginLeft = Math.random() * 10 + "px";
            
            if(count >= quota) {
                document.getElementById('rock-area').style.display = 'none';
                document.getElementById('finishArea').style.display = 'block';
                document.getElementById('resultCode').innerText = dailyCode;
                document.getElementById('status').innerText = "ãƒãƒ«ãƒé”æˆ";
            }
        };

        function updateUI() {
            counter.innerText = `${count} / ${quota}`;
            fill.style.width = (count / quota * 100) + "%";
        }

        // ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ï¼š5ç§’é–“æ“ä½œãŒãªã„ã¨ã‚«ã‚¦ãƒ³ãƒˆãŒå°‘ã—æ¸›ã‚‹ï¼ˆå¤§å¤‰ã«ã™ã‚‹æ¼”å‡ºï¼‰
        setInterval(() => {
            if (Date.now() - lastClick > 5000 && count > 0 && count < quota) {
                count--;
                updateUI();
                document.getElementById('status').innerHTML = "<span class='warning'>âš ï¸ ç›£è¦–å“¡ã€ŒãŠã„ã€æ‰‹ãŒæ­¢ã¾ã£ã¦ã‚‹ãï¼ã€ (-1)</span>";
            } else if (count < quota) {
                document.getElementById('status').innerText = "ç›£è¦–ä¸­...";
            }
        }, 2000);
    </script>
</body>
</html>

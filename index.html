<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ç¬¬å››å¼·åˆ¶åŠ´åƒåŒº</title>
    <style>
        /* å…¨è§’ã‚¹ãƒšãƒ¼ã‚¹ã‚„ä¸è¦ãªæ–‡å­—ã‚’ã™ã¹ã¦é™¤å»ã—ã¾ã—ãŸ */
        body { background: #000; color: #0f0; font-family: monospace; text-align: center; margin: 0; overflow: hidden; height: 100vh; }
        #error-screen { display: none; margin-top: 30vh; color: red; font-size: 24px; }
        #game-screen { display: none; width: 100vw; height: 100vh; position: relative; }
        #ui { position: fixed; top: 0; width: 100%; background: rgba(0,0,0,0.9); padding: 15px; border-bottom: 2px solid #333; z-index: 100; }
        
        /* çŸ³ãŒç¢ºå®Ÿã«ã‚¯ãƒªãƒƒã‚¯ã§ãã‚‹ã‚ˆã† z-index ã‚’è¿½åŠ  */
        .rock { 
            position: absolute; 
            font-size: 80px; 
            transform: translate(-50%, -50%); 
            cursor: pointer; 
            z-index: 50;
            user-select: none;
        }
        
        #finish-screen { display: none; margin-top: 25vh; }
        .code-box { color: #ff0; font-size: 32px; border: 3px dashed #ff0; padding: 20px; display: inline-block; margin: 20px; background: #110; }
    </style>
</head>
<body>

    <div id="error-screen"><h1>âš ï¸ ACCESS DENIED âš ï¸</h1><p>Discordã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„</p></div>

    <div id="game-screen">
        <div id="ui">
            <h2 id="counter">é€²æ—: 0 / 200</h2>
            <div id="status">CLICK THE ROCK</div>
        </div>
        <div id="rock" class="rock" onclick="hit()" style="left: 50%; top: 50%;">ğŸª¨</div>
    </div>

    <div id="finish-screen">
        <h1>â›ï¸ ãƒãƒ«ãƒé”æˆ â›ï¸</h1>
        <p>å®Œäº†ã‚³ãƒ¼ãƒ‰ï¼ˆä¸€åº¦ã®ã¿æœ‰åŠ¹ï¼‰:</p>
        <div id="resultCode" class="code-box"></div>
        <p>Discordã§ /claim ã‚’å®Ÿè¡Œã›ã‚ˆ</p>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const uid = urlParams.get('id');

        // IDã®åˆ¤å®šã‚’å³æ ¼åŒ–
        if (!uid || isNaN(uid) || uid.length < 15) {
            document.getElementById('error-screen').style.display = 'block';
        } else {
            document.getElementById('game-screen').style.display = 'block';
            move(); // æœ€åˆã®ä½ç½®ã‚’æ±ºå®š
        }

        let count = 0;
        const quota = 200;

        function generateRandomLookingCode(id) {
            const date = new Date().toISOString().slice(0, 10);
            const salt = "SECRET_ZIMU_99"; 
            const raw = id + date + salt;
            let hash = 0;
            for (let i = 0; i < raw.length; i++) {
                hash = ((hash << 5) - hash) + raw.charCodeAt(i);
                hash |= 0; 
            }
            return "RX-" + Math.abs(hash).toString(36).toUpperCase() + "-" + btoa(id).slice(-4).toUpperCase();
        }

        function move() {
            const r = document.getElementById('rock');
            // ç”»é¢ç«¯ã«è¡Œãéããªã„ã‚ˆã†ã«èª¿æ•´
            const x = Math.random() * 80 + 10;
            const y = Math.random() * 60 + 25;
            r.style.left = x + "%";
            r.style.top = y + "%";
        }

        function hit() {
            if (count >= quota) return;
            count++;
            document.getElementById('counter').innerText = `é€²æ—: ${count} / ${quota}`;
            document.getElementById('status').innerText = "âœ… HIT!";
            move();
            if (count >= quota) {
                document.getElementById('game-screen').style.display = 'none';
                document.getElementById('finish-screen').style.display = 'block';
                document.getElementById('resultCode').innerText = generateRandomLookingCode(uid);
            }
        }
    </script>
</body>
</html>
